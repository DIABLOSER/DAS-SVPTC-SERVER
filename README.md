# 📦 服务端（Server）

服务端基于 Python 的 Flask 框架开发，主要负责处理前端请求、调用 Bilibili 接口、分析评论数据，并将可视化图表和分析结果返回前端展示。

---

## 🚀 功能模块

### 1. 用户扫码登录（基于 Bilibili 二维码）

- 获取登录二维码：`/api/qrcode`
- 轮询二维码状态：`/api/qrcode/polling`
- 获取用户登录凭证：返回 `SESSDATA`、`DedeUserID`

> ✅ 使用模拟浏览器行为完成扫码登录，无需用户输入账号密码，兼顾安全性与用户便利性。

---

### 2. 用户信息与投稿数据

- 获取用户基本信息（昵称、头像、粉丝数等）
- 获取用户投稿视频列表（支持分页）
- 获取单个视频详情信息（播放地址、时长、点赞数、评论数等）

---

### 3. 评论数据获取与分析

- 分页获取评论列表
- 评论数据多维分析：
  - 情感分析（正面 / 中性 / 负面）
  - 评论词频统计
  - 用户性别与地区分布
  - 评论发布时间趋势分析
  - KMeans 文本聚类分析

---

### 4. 可视化图表生成

以下图表均自动生成并保存在 `output/` 目录中，前端可通过静态资源方式访问：

- 词云图（评论关键词）
- 性别分布图（饼状图）
- 评论时间趋势图（折线图）
- 情感极性分析柱状图
- 用户地区分布图
- 聚类结果散点图（基于文本相似度）

---

### 5. 代理服务

- 图片代理：用于解决跨域问题，支持直接展示 B 站图片
- 视频代理：支持视频流式传输，绕过防盗链限制

---

### 6. 文件与日志管理

- 所有评论分析结果保存为 `.csv` 文件，便于本地下载与二次研究
- 支持运行日志、请求日志与错误日志记录，方便调试与维护

---

## 📁 目录结构示意

```bash
server/
├── server.py                # Flask 应用主入口
├── bilibili_api.py          # B站相关接口处理模块
├── analysis.py              # 评论分析模块（情感、聚类等）
├── charts_generator.py      # 图表绘制模块
├── utils.py                 # 工具函数与代理方法
├── output/                  # 自动生成的图表、分析文件目录
├── static/                  # 前端可访问的图表与数据
└── requirements.txt         # 后端依赖库列表

